<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Acceptance Tests With JBehave, Selenium & Page Objects</title>
  <!-- <meta name="description" content="<p>Since <a href="http://jbehave.org">JBehave 2.0</a> was released in September, I&#39;ve been using it on my current project to verify the acceptance criteria for the features we are implementing, ensuring that the web interface is following the right workflow, and is displaying the data as expected, as well as some other important elements.</p>
" /> -->

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@amartinsn" />
    <meta name="twitter:title" content="Acceptance Tests With JBehave, Selenium & Page Objects" />
    <meta name="twitter:image" content="http://alexmartins.me/assets/images/author.jpg" />
    
    <meta name="twitter:description"  content="Since JBehave 2.0 was released in September, I&#39;ve been using it on my current project to verify the acceptance criteria for the features we are implementing, ensuring that the web interface is ..." />
    
  

  <meta property="og:site_name" content="Alexandre Martins" />
  <meta property="og:title" content="Acceptance Tests With JBehave, Selenium & Page Objects"/>
  
  <meta property="og:description" content="Since JBehave 2.0 was released in September, I&#39;ve been using it on my current project to verify the acceptance criteria for the features we are implementing, ensuring that the web interface is ..." />
  
  <meta property="og:image" content="http://alexmartins.me/assets/images/author.jpg" />
  <meta property="og:url" content="http://alexmartins.me/acceptance-tests-with-jbehave-selenium-page-objects" >
  <meta property="og:type" content="blog" />
  <meta property="article:published_time" content="2008-11-14T00:00:00-02:00">

  <link rel="canonical" href="http://alexmartins.me/acceptance-tests-with-jbehave-selenium-page-objects">

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->

<!-- <a href="http://alexmartins.me" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/author.jpg)"></span></a> -->

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Acceptance Tests With JBehave, Selenium & Page Objects</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <a class="author-name" href="http://alexmartins.me" itemprop="author" itemscope itemtype="http://schema.org/Person">Alexandre Martins</a>
              on
              <time datetime="2008-11-14T00:00:00-02:00">14 Nov 2008</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
          </div>
        </div>
        <br>
        <br>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>Since <a href="http://jbehave.org">JBehave 2.0</a> was released in September, I&#39;ve been using it on my current project to verify the acceptance criteria for the features we are implementing, ensuring that the web interface is following the right workflow, and is displaying the data as expected, as well as some other important elements.</p>

<h3>What is JBehave?</h3>

<p>JBehave is a framework for <a href="http://behaviour-driven.org">Behaviour-Driven Development</a>, that allows customers and developers to work together more closely on features for the system. They get together to discuss and define a set of executable criteria (scenarios) for each of the features that will be used to determine if they are fully implemented or not. The cool thing is that the scenario execution produces an easy-to-read output, so that customers can keep track of the implementation status.</p>

<h3>An Example</h3>

<p>In this example, I&#39;m not covering all the bits and pieces about writing and running acceptance tests with JBehave. If you want to see it in details, there&#39;s a very good introduction article <a href="http://www.ryangreenhall.com/articles/bdd-by-example.html">here</a>. The intention is to show how we are doing it on my project, integrating with <a href="http://selenium.openqa.org/">Selenium</a> and using the <a href="http://code.google.com/p/webdriver/wiki/PageObjects">Page Objects</a> pattern.</p>

<h4>New Feature</h4>

<p>Suppose the customer wanted to provide exclusive content for the user of the website. For that, we would have to implement an authentication framework, so that we could guarantee that only registered users would access that content. So the story looks like this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">As an user
I want to login into the website
So that I can view the exclusive contents
</code></pre></div>
<h4>Defining Scenarios</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">Scenario: Invalid Username
Given the user is on the login page
 When the user types username wrong!
  And the user types password 123456
  And clicks the login button
 Then the page should display Invalid Authentication message

Scenario: Successful Login
Given the user is on the login page
 When the user types username alexandre
  And the user types password 123456
  And clicks the login button
 Then the user should be redirected to home page
  And the page should display welcome message to alexandre
</code></pre></div>
<p>Each scenario needs its own implementation, providing the necessary steps to be verified, in our case the LoginSteps class. Another improvement on version 2.0 is that it allows you to define multiple scenarios in a single file.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginScenarios</span> <span class="kd">extends</span> <span class="n">Scenario</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">LoginScenarios</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="k">new</span> <span class="nf">LoginSteps</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<h4>Defining Steps (Integrating Selenium)</h4>

<p>After defining the scenarios on the text file, it&#39;s time to map each scenario step to its implementation. Once you start mapping them you will come across ones that are already mapped, and will realise that defining new scenarios is just a matter of combining existing steps.</p>

<p>Initially, for each step, we were extracting the code sniped from Selenium IDE record and placing into it. But it felt a bit clumsy, with code duplication in some spots. It quickly reminded me how hard it is to maintain a suite of tests when it starts evolve and there is not enough effort on refactoring. We wanted to avoid duplication and come up with a more elegant and reusable solution.</p>

<p>One day my friend Uday Rayala came up with the idea of using the Page Objects pattern for writing our acceptance tests, so that we could encapsulate the logic to interact and verify page state into these objects. The first time I heard about it was from <a href="http://pubbitch.org/blog/">Simon Stewart</a>, when he was in Sydney for the JAOO conference. He said that they implemented <a href="http://code.google.com/p/webdriver/">WebDriver</a> based on this pattern, and showed me some examples. Here is a definition, extracted from the WebDriver wikipage:</p>

<blockquote>
<p>Within your web app&#39;s UI there are areas that your tests interact with. A Page Object simply models these as objects within the test code. This reduces the amount of duplicated code and means that if the UI changes, the fix need only be applied in one place.</p>
</blockquote>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginSteps</span> <span class="kd">extends</span> <span class="n">Steps</span> <span class="o">{</span>

    <span class="nd">@Given</span><span class="o">(</span><span class="s">&quot;the user is on the login page&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theUserIsOnTheLoginPage</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">LoginPage</span> <span class="n">loginPage</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">LoginPage</span><span class="o">();</span>
        <span class="n">loginPage</span><span class="o">.</span><span class="na">verifyPresenceOfUsernameAndPasswordFields</span><span class="o">();</span>
        <span class="n">loginPage</span><span class="o">.</span><span class="na">verifyPresenceOfLoginButton</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@When</span><span class="o">(</span><span class="s">&quot;the user types username $username&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theUserTypesUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">loginPage</span><span class="o">().</span><span class="na">typeUsername</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@When</span><span class="o">(</span><span class="s">&quot;the user types password $password&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theUserTypesPassword</span><span class="o">(</span><span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">loginPage</span><span class="o">().</span><span class="na">typePassword</span><span class="o">(</span><span class="n">password</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@When</span><span class="o">(</span><span class="s">&quot;clicks the login button&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clicksTheLoginButton</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">loginPage</span><span class="o">().</span><span class="na">login</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Then</span><span class="o">(</span><span class="s">&quot;the page should display $errorMessage message&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">thePageShouldDisplayErrorMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">errorMessage</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">loginPage</span><span class="o">().</span><span class="na">verifyPresenceOfErrorMessage</span><span class="o">(</span><span class="n">errorMessage</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Then</span><span class="o">(</span><span class="s">&quot;the user should be redirected to home page&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">theUserShouldBeRedirectedToHomePage</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">HomePage</span> <span class="n">homePage</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">HomePage</span><span class="o">();</span>
        <span class="n">homePage</span><span class="o">.</span><span class="na">verifyPage</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Then</span><span class="o">(</span><span class="s">&quot;the page should display welcome message to $user&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">thePageShouldDisplayWelcomeMessage</span><span class="o">(</span><span class="n">String</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">homePage</span><span class="o">().</span><span class="na">verifyPresenceOfWelcomeMessageTo</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">LoginPage</span> <span class="nf">loginPage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">LoginPage</span><span class="o">)</span> <span class="n">Page</span><span class="o">.</span><span class="na">current</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">HomePage</span> <span class="nf">homePage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">HomePage</span><span class="o">)</span> <span class="n">Page</span><span class="o">.</span><span class="na">current</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Acceptance+Tests+With+JBehave%2C+Selenium+%26+Page+Objects&amp;url=http://alexmartins.me/acceptance-tests-jbehave"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <h5 class="index-headline featured"><span>Written by</span></h5>
          <section class="author">
            <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
            <h4>Alexandre Martins</h4>
            <p class="bio">Tech Lead and Agile Coach. Currently helping build the technology vision and architecture of Globo's video streaming platform.</p>
            <p class="published">Published <time datetime="2008-11-14 00:00">14 Nov 2008</time></p>
          </section>
          
        </div>
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'alexmartins'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        
      </article>
    </main>
    <div class="bottom-closer">

    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');

      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67119919-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
